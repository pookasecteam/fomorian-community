{
  "_metadata": {
    "attack_id": "T1003.001",
    "variation": "002",
    "name": "comsvcs.dll MiniDump",
    "description": "Abuses rundll32 with comsvcs.dll to dump LSASS memory. LOLBin technique.",
    "expected_detection": "CRITICAL",
    "expected_soar": "credential-dumping-response",
    "notes": "Uses legitimate Windows DLL. Often used when procdump is blocked.",
    "format": "wazuh-native",
    "format_version": "1.0"
  },
  "logs": [
    {
      "_comment": "Sysmon Event 1 - rundll32 executing comsvcs MiniDump",
      "sequence": 1,
      "timestamp": "2026-01-29T15:45:22.333Z",
      "log": {
        "timestamp": "",
        "rule": {
          "level": 12,
          "description": "Sysmon - Event 1: comsvcs.dll MiniDump",
          "id": "100100",
          "mitre": {
            "id": [
              "T1003.001"
            ],
            "tactic": [
              "Unknown"
            ],
            "technique": [
              "comsvcs.dll MiniDump"
            ]
          },
          "firedtimes": 1,
          "mail": false,
          "groups": [
            "sysmon",
            "sysmon_event1",
            "windows"
          ]
        },
        "agent": {
          "id": "007",
          "name": "WS01",
          "ip": "10.1.0.20"
        },
        "manager": {
          "name": "wazuh.manager"
        },
        "id": "1700000000.40647180",
        "decoder": {
          "name": "windows_eventchannel"
        },
        "location": "EventChannel",
        "data": {
          "win": {
            "system": {
              "eventID": "1",
              "channel": "Microsoft-Windows-Sysmon/Operational",
              "providerName": "Microsoft-Windows-Sysmon",
              "computer": "WS01.corp.local",
              "level": "4",
              "task": "1",
              "opcode": "0",
              "keywords": "0x8000000000000000",
              "severityValue": "INFORMATION"
            },
            "eventdata": {
              "ruleName": "",
              "utcTime": "2026-01-29 15:45:22.333",
              "processGuid": "{12345678-2222-2222-2222-222222222001}",
              "processId": "6688",
              "image": "C:\\Windows\\System32\\rundll32.exe",
              "fileVersion": "10.0.19041.1 (WinBuild.160101.0800)",
              "description": "Windows host process (Rundll32)",
              "product": "Microsoft\u00ae Windows\u00ae Operating System",
              "company": "Microsoft Corporation",
              "originalFileName": "RUNDLL32.EXE",
              "commandLine": "rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump 672 C:\\Windows\\Temp\\dump.bin full",
              "currentDirectory": "C:\\Windows\\System32\\",
              "user": "CORP\\admin.user",
              "logonGuid": "{12345678-2222-2222-2222-222222222000}",
              "logonId": "0x4A2F1",
              "terminalSessionId": "1",
              "integrityLevel": "High",
              "hashes": "SHA256=BBF252D5E9A6B3C7D8E9F0A1B2C3D4E5F6A7B8C9D0E1F2A3B4C5D6E7F8A9B0C1",
              "parentProcessGuid": "{12345678-2222-2222-2222-222222222000}",
              "parentProcessId": "3344",
              "parentImage": "C:\\Windows\\System32\\cmd.exe",
              "parentCommandLine": "\"C:\\Windows\\System32\\cmd.exe\"",
              "parentUser": "CORP\\admin.user"
            }
          }
        }
      }
    },
    {
      "_comment": "Sysmon Event 10 - rundll32 accessing LSASS",
      "sequence": 2,
      "timestamp": "2026-01-29T15:45:22.567Z",
      "log": {
        "timestamp": "",
        "rule": {
          "level": 12,
          "description": "Sysmon - Event 10: comsvcs.dll MiniDump",
          "id": "100100",
          "mitre": {
            "id": [
              "T1003.001"
            ],
            "tactic": [
              "Unknown"
            ],
            "technique": [
              "comsvcs.dll MiniDump"
            ]
          },
          "firedtimes": 1,
          "mail": false,
          "groups": [
            "sysmon",
            "sysmon_event10",
            "windows"
          ]
        },
        "agent": {
          "id": "007",
          "name": "WS01",
          "ip": "10.1.0.20"
        },
        "manager": {
          "name": "wazuh.manager"
        },
        "id": "1700000000.734674177",
        "decoder": {
          "name": "windows_eventchannel"
        },
        "location": "EventChannel",
        "data": {
          "win": {
            "system": {
              "eventID": "10",
              "channel": "Microsoft-Windows-Sysmon/Operational",
              "providerName": "Microsoft-Windows-Sysmon",
              "computer": "WS01.corp.local",
              "level": "4",
              "task": "1",
              "opcode": "0",
              "keywords": "0x8000000000000000",
              "severityValue": "INFORMATION"
            },
            "eventdata": {
              "ruleName": "",
              "utcTime": "2026-01-29 15:45:22.567",
              "sourceProcessGUID": "{12345678-2222-2222-2222-222222222001}",
              "sourceProcessId": "6688",
              "sourceThreadId": "6692",
              "sourceImage": "C:\\Windows\\System32\\rundll32.exe",
              "targetProcessGUID": "{12345678-0000-0000-0000-000000000001}",
              "targetProcessId": "672",
              "targetImage": "C:\\Windows\\System32\\lsass.exe",
              "grantedAccess": "0x1010",
              "callTrace": "C:\\Windows\\SYSTEM32\\ntdll.dll+9d4c4|C:\\Windows\\System32\\comsvcs.dll+4f21c",
              "sourceUser": "CORP\\admin.user",
              "targetUser": "NT AUTHORITY\\SYSTEM"
            }
          }
        }
      }
    }
  ]
}