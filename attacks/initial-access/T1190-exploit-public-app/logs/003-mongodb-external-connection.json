{
  "_metadata": {
    "attack_id": "T1190",
    "variation": "003",
    "name": "MongoDB External Connection",
    "description": "Simulates connection to external MongoDB instance indicating potential exposure or data exfiltration",
    "expected_detection": "MEDIUM",
    "kill_chain_phase": "initial-access",
    "format": "wazuh-native",
    "format_version": "1.0",
    "references": ["https://www.bleepingcomputer.com/news/security/exposed-mongodb-instances-still-targeted-in-data-extortion-attacks/"]
  },
  "logs": [
    {
      "_comment": "Sysmon Event 3 - Network connection to external MongoDB",
      "sequence": 1,
      "timestamp": "2026-02-02T21:10:00.000Z",
      "log": {
        "timestamp": "2026-02-02T21:10:00.000+0000",
        "rule": {
          "level": 5,
          "description": "Sysmon - Event 3: Network connection detected",
          "id": "92003",
          "firedtimes": 1,
          "mail": false,
          "groups": ["sysmon", "sysmon_event3", "windows"]
        },
        "agent": {"id": "007", "name": "WS01", "ip": "10.1.0.20"},
        "manager": {"name": "wazuh.manager"},
        "id": "1706900600.300001",
        "decoder": {"name": "windows_eventchannel"},
        "location": "EventChannel",
        "_fomorian_test": true,
        "_fomorian_batch": "intel-digest-20260202",
        "data": {
          "win": {
            "system": {
              "eventID": "3",
              "channel": "Microsoft-Windows-Sysmon/Operational",
              "providerName": "Microsoft-Windows-Sysmon",
              "computer": "WS01.corp.local",
              "level": "4",
              "task": "3",
              "severityValue": "INFORMATION",
              "systemTime": "2026-02-02T21:10:00.000000000Z"
            },
            "eventdata": {
              "utcTime": "2026-02-02 21:10:00.000",
              "processGuid": "{12345678-1234-1234-1234-300000000001}",
              "processId": "3456",
              "image": "C:\\Program Files\\MongoDB\\Server\\6.0\\bin\\mongosh.exe",
              "user": "CORP\\dbadmin",
              "protocol": "tcp",
              "initiated": "true",
              "sourceIsIpv6": "false",
              "sourceIp": "10.1.0.20",
              "sourceHostname": "WS01.corp.local",
              "sourcePort": "49832",
              "sourcePortName": "-",
              "destinationIsIpv6": "false",
              "destinationIp": "45.33.32.156",
              "destinationHostname": "exposed-mongo.attacker.com",
              "destinationPort": "27017",
              "destinationPortName": "mongodb"
            }
          }
        }
      }
    },
    {
      "_comment": "Sysmon Event 3 - Second connection to different external MongoDB",
      "sequence": 2,
      "timestamp": "2026-02-02T21:10:30.000Z",
      "log": {
        "timestamp": "2026-02-02T21:10:30.000+0000",
        "rule": {
          "level": 5,
          "description": "Sysmon - Event 3: Network connection detected",
          "id": "92003",
          "firedtimes": 2,
          "mail": false,
          "groups": ["sysmon", "sysmon_event3", "windows"]
        },
        "agent": {"id": "007", "name": "WS01", "ip": "10.1.0.20"},
        "manager": {"name": "wazuh.manager"},
        "id": "1706900630.300002",
        "decoder": {"name": "windows_eventchannel"},
        "location": "EventChannel",
        "_fomorian_test": true,
        "_fomorian_batch": "intel-digest-20260202",
        "data": {
          "win": {
            "system": {
              "eventID": "3",
              "channel": "Microsoft-Windows-Sysmon/Operational",
              "providerName": "Microsoft-Windows-Sysmon",
              "computer": "WS01.corp.local",
              "level": "4",
              "task": "3",
              "severityValue": "INFORMATION",
              "systemTime": "2026-02-02T21:10:30.000000000Z"
            },
            "eventdata": {
              "utcTime": "2026-02-02 21:10:30.000",
              "processGuid": "{12345678-1234-1234-1234-300000000002}",
              "processId": "3456",
              "image": "C:\\Program Files\\MongoDB\\Server\\6.0\\bin\\mongosh.exe",
              "user": "CORP\\dbadmin",
              "protocol": "tcp",
              "initiated": "true",
              "sourceIsIpv6": "false",
              "sourceIp": "10.1.0.20",
              "sourceHostname": "WS01.corp.local",
              "sourcePort": "49835",
              "sourcePortName": "-",
              "destinationIsIpv6": "false",
              "destinationIp": "185.220.101.45",
              "destinationHostname": "",
              "destinationPort": "27017",
              "destinationPortName": "mongodb"
            }
          }
        }
      }
    }
  ]
}
