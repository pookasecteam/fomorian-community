{
  "_metadata": {
    "attack_id": "T1021.006",
    "variation": "001",
    "name": "DCOM Remote Execution - impacket-dcomexec",
    "description": "Attacker uses impacket-dcomexec to execute commands via DCOM (MMC20.Application)",
    "expected_detection": "HIGH",
    "kill_chain_phase": "lateral-movement",
    "tool": "impacket-dcomexec",
    "command": "impacket-dcomexec yourcompany.local/Administrator:\"\"@10.1.0.99 \"whoami\"",
    "impact": "Remote code execution without creating services",
    "format": "wazuh-native",
    "format_version": "1.0"
  },
  "logs": [
    {
      "_comment": "Event 4688 - MMC.exe spawned by DCOM",
      "sequence": 1,
      "timestamp": "2026-02-11T04:00:00.000Z",
      "log": {
        "timestamp": "2026-02-11T04:00:00.000Z",
        "rule": {
          "level": 3,
          "description": "Windows Eventchannel event",
          "id": "60009",
          "firedtimes": 1,
          "mail": false,
          "groups": [
            "windows",
            "eventchannel"
          ]
        },
        "agent": {
          "id": "012",
          "name": "DC01",
          "ip": "10.1.0.99"
        },
        "manager": {
          "name": "wazuh.manager"
        },
        "id": "1707629000.500001",
        "decoder": {
          "name": "windows_eventchannel"
        },
        "location": "EventChannel",
        "data": {
          "win": {
            "system": {
              "eventID": "4688",
              "channel": "Security",
              "providerName": "Microsoft-Windows-Security-Auditing",
              "computer": "DC01.yourcompany.local",
              "level": "0",
              "keywords": "0x8020000000000000",
              "severityValue": "AUDIT_SUCCESS"
            },
            "eventdata": {
              "subjectUserName": "Administrator",
              "newProcessName": "mmc.exe",
              "commandLine": "C:\\Windows\\System32\\mmc.exe -Embedding",
              "parentProcessName": "svchost.exe"
            }
          }
        }
      }
    }
  ]
}