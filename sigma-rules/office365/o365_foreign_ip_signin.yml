title: Office 365 Sign In From Known Malicious Country
id: 5b6a8c90-1234-4abc-def0-123456789011
status: experimental
description: Detects sign-ins from countries commonly associated with threat actors
author: PookaSec
date: 2026/01/29
references:
    - https://attack.mitre.org/techniques/T1078/004/
tags:
    - attack.initial_access
    - attack.t1078.004
logsource:
    product: azure
    service: signinlogs
detection:
    selection:
        azure_ad_signin.status.error_code: 0
    suspicious_countries:
        azure_ad_signin.location.country_or_region|contains:
            - 'RU'
            - 'CN'
            - 'KP'
            - 'IR'
            - 'BY'
    condition: selection and suspicious_countries
fields:
    - azure_ad_signin.user_principal_name
    - azure_ad_signin.ip_address
    - azure_ad_signin.location.country_or_region
    - azure_ad_signin.location.city
falsepositives:
    - Legitimate users traveling or using VPN
    - International business operations
level: medium
